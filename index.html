<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Decoding Our Love üíñ</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
:root{
  --love:#ff4d6d;
  --pink:#ffb3c6;
  --gold:#ffd700;
  --purple:#a855f7;
  --deep-purple:#7c3aed;
}

* {
  box-sizing: border-box;
}

body{
  margin:0;
  background: linear-gradient(135deg, #1a0033 0%, #2d0a4e 25%, #4a1472 50%, #2d0a4e 75%, #1a0033 100%);
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
  color:white;
  font-family:'Poppins',sans-serif;
  overflow:hidden;
  height:100vh;
  position: relative;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Floating particles */
.particle {
  position: absolute;
  width: 4px;
  height: 4px;
  background: radial-gradient(circle, rgba(255,255,255,0.8), transparent);
  border-radius: 50%;
  animation: float 8s infinite ease-in-out;
  opacity: 0.6;
}

@keyframes float {
  0%, 100% { transform: translateY(0) translateX(0); }
  25% { transform: translateY(-30px) translateX(10px); }
  50% { transform: translateY(-60px) translateX(-10px); }
  75% { transform: translateY(-30px) translateX(5px); }
}

#quest-container{
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  height:100%;
  text-align:center;
  position: relative;
  z-index: 2;
}

.step{
  display:none;
  max-width:480px;
  padding: 30px;
  animation: fadeSlideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.step.active{display:block}

@keyframes fadeSlideIn{
  from{
    opacity:0;
    transform:translateY(40px) scale(0.95);
  }
  to{
    opacity:1;
    transform:translateY(0) scale(1);
  }
}

.step h2 {
  font-family: 'Playfair Display', serif;
  font-size: 2.5rem;
  margin-bottom: 15px;
  background: linear-gradient(135deg, var(--pink), var(--love), var(--gold));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 30px rgba(255, 77, 109, 0.3);
  animation: textGlow 3s ease-in-out infinite;
}

@keyframes textGlow {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.3); }
}

.step p {
  font-size: 1.1rem;
  color: rgba(255, 255, 255, 0.9);
  line-height: 1.6;
  margin: 10px 0;
}

.heart-main{
  font-size:140px;
  cursor:pointer;
  animation: heartPulse 2s infinite ease-in-out;
  filter: drop-shadow(0 0 40px var(--love)) drop-shadow(0 0 80px rgba(255, 77, 109, 0.4));
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-block;
  margin: 20px 0;
}

.heart-main:hover {
  transform: scale(1.1) rotate(5deg);
}

.heart-main:active {
  transform: scale(0.95);
}

@keyframes heartPulse{
  0%, 100%{transform:scale(1)}
  25%{transform:scale(1.1) rotate(-5deg)}
  75%{transform:scale(1.05) rotate(5deg)}
}

.hint{
  font-size:0.95rem;
  color:#e0b3ff;
  font-style:italic;
  margin-top:15px;
  animation: hintGlow 2s ease-in-out infinite;
}

@keyframes hintGlow {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

/* Slider styling */
#dateValue {
  font-size: 2rem;
  color: var(--gold);
  font-weight: 600;
  margin: 20px 0;
  text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
  font-family: 'Playfair Display', serif;
}

input[type="range"] {
  width: 100%;
  max-width: 350px;
  height: 8px;
  background: linear-gradient(90deg, rgba(255,255,255,0.2), rgba(168, 85, 247, 0.4));
  border-radius: 10px;
  outline: none;
  margin-top: 20px;
  appearance: none;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.1);
}

input[type="range"]::-webkit-slider-thumb {
  appearance: none;
  width: 24px;
  height: 24px;
  background: linear-gradient(135deg, var(--love), var(--pink));
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0 20px var(--love);
  transition: all 0.3s ease;
}

input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.3);
  box-shadow: 0 0 30px var(--love);
}

input[type="range"]::-moz-range-thumb {
  width: 24px;
  height: 24px;
  background: linear-gradient(135deg, var(--love), var(--pink));
  border-radius: 50%;
  cursor: pointer;
  box-shadow: 0 0 20px var(--love);
  border: none;
}

.star{
  position:absolute;
  font-size:36px;
  cursor:pointer;
  animation: starTwinkle 2.5s infinite ease-in-out;
  filter: drop-shadow(0 0 15px var(--gold));
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.star:hover {
  transform: scale(1.4) rotate(180deg);
  filter: drop-shadow(0 0 30px var(--gold));
}

@keyframes starTwinkle{
  0%, 100%{opacity:0.5; transform:scale(1) rotate(0deg)}
  50%{opacity:1; transform:scale(1.2) rotate(180deg)}
}

#star-field {
  position: relative;
  height: 320px;
  width: 100%;
  margin-top: 30px;
  background: radial-gradient(ellipse at center, rgba(168, 85, 247, 0.15), transparent);
  border-radius: 20px;
  backdrop-filter: blur(5px);
  border: 1px solid rgba(255,255,255,0.1);
}

#final-btn{
  padding: 18px 45px;
  border-radius: 50px;
  border: none;
  background: linear-gradient(135deg, white, var(--pink));
  color: var(--love);
  font-weight: 700;
  font-size: 1.1rem;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 10px 40px rgba(255, 77, 109, 0.4);
  position: relative;
  margin-top: 20px;
}

#final-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 50px rgba(255, 77, 109, 0.6);
}

#catch-msg {
  margin-top: 20px;
  font-size: 1.1rem;
  color: var(--gold);
  font-weight: 600;
}

/* Memory Modal - Glassy and Romantic */
#memoryModal{
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  backdrop-filter: blur(12px);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 100;
  animation: modalFadeIn 0.4s ease;
}

@keyframes modalFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.memory-box{
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.1), 
    rgba(255, 179, 198, 0.15)
  );
  backdrop-filter: blur(20px);
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 30px;
  padding: 30px;
  max-width: 380px;
  width: 90%;
  text-align: center;
  color: white;
  box-shadow: 
    0 20px 60px rgba(0, 0, 0, 0.5),
    inset 0 1px 0 rgba(255, 255, 255, 0.3);
  animation: modalSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

@keyframes modalSlideIn {
  from {
    opacity: 0;
    transform: translateY(50px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.memory-box::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1), transparent 70%);
  animation: shimmer 3s infinite;
  pointer-events: none;
}

@keyframes shimmer {
  0% { transform: translate(-50%, -50%) rotate(0deg); }
  100% { transform: translate(-50%, -50%) rotate(360deg); }
}

.memory-box img{
  width: 100%;
  border-radius: 20px;
  margin-bottom: 20px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
  border: 3px solid rgba(255, 255, 255, 0.3);
  position: relative;
  z-index: 1;
}

.memory-box p {
  font-size: 1.05rem;
  line-height: 1.6;
  color: rgba(255, 255, 255, 0.95);
  font-style: italic;
  position: relative;
  z-index: 1;
}

.memory-box button{
  margin-top: 20px;
  padding: 12px 35px;
  border: none;
  border-radius: 30px;
  background: linear-gradient(135deg, var(--love), var(--purple));
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 5px 20px rgba(255, 77, 109, 0.4);
  position: relative;
  z-index: 1;
}

.memory-box button:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 30px rgba(255, 77, 109, 0.6);
}

/* Final reveal card */
.final-card {
  background: linear-gradient(135deg, 
    rgba(255, 255, 255, 0.95), 
    rgba(255, 179, 198, 0.9)
  );
  backdrop-filter: blur(20px);
  padding: 35px;
  border-radius: 30px;
  color: #2d0a4e;
  box-shadow: 
    0 25px 80px rgba(255, 77, 109, 0.5),
    inset 0 1px 0 rgba(255, 255, 255, 0.8);
  border: 2px solid rgba(255, 255, 255, 0.5);
  animation: finalReveal 1s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes finalReveal {
  from {
    opacity: 0;
    transform: scale(0.8) rotateY(90deg);
  }
  to {
    opacity: 1;
    transform: scale(1) rotateY(0deg);
  }
}

.final-card img {
  width: 100%;
  border-radius: 20px;
  margin-bottom: 20px;
  box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
  border: 4px solid rgba(255, 255, 255, 0.8);
}

.final-card h2 {
  color: var(--love);
  margin: 15px 0;
}

.final-card p {
  color: #4a1472;
  font-size: 1.1rem;
}

/* Sparkle effect */
.sparkle {
  position: fixed;
  width: 8px;
  height: 8px;
  background: radial-gradient(circle, #fff, var(--gold));
  border-radius: 50%;
  pointer-events: none;
  animation: sparkleFade 1s ease-out forwards;
  z-index: 999;
  box-shadow: 0 0 10px var(--gold);
}

@keyframes sparkleFade {
  0% { 
    transform: scale(1) translateY(0); 
    opacity: 1; 
  }
  100% { 
    transform: scale(0) translateY(-30px); 
    opacity: 0; 
  }
}

/* Floating hearts background */
.floating-heart {
  position: absolute;
  font-size: 20px;
  opacity: 0.15;
  animation: floatHeart 15s infinite ease-in-out;
  pointer-events: none;
}

@keyframes floatHeart {
  0% {
    transform: translateY(100vh) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 0.15;
  }
  90% {
    opacity: 0.15;
  }
  100% {
    transform: translateY(-100px) rotate(360deg);
    opacity: 0;
  }
}

</style>
</head>

<body>

<audio id="bg-music" loop>
  <source src="happyBirthday.mp3" type="audio/mpeg">
</audio>

<div id="quest-container">

<!-- STEP 1 -->
<div id="step1" class="step active">
  <h2>üí´ Love Initialization</h2>
  <p>Every miracle begins with a heartbeat‚Ä¶</p>
  <div class="heart-main" onclick="nextStep(2,event)">‚ù§Ô∏è</div>
  <p class="hint">Touch my heart to begin our story‚Ä¶</p>
</div>

<!-- STEP 2 -->
<div id="step2" class="step">
  <h2>üìñ Our First Chapter</h2>
  <p>Slide to the month destiny introduced us.</p>
  <div id="dateValue">January</div>
  <input type="range" min="1" max="12" value="1" oninput="updateSlider(this.value)">
  <p class="hint">Find the month our hearts collided‚Ä¶</p>
</div>

<!-- STEP 3 -->
<div id="step3" class="step">
  <h2>‚ú® Memory Constellation</h2>
  <p>Each star holds a moment of us‚Ä¶ open them all üí´</p>
  <div id="star-field">
    <span class="star" onclick="openMemory(0)">‚≠ê</span>
    <span class="star" onclick="openMemory(1)">‚≠ê</span>
    <span class="star" onclick="openMemory(2)">‚≠ê</span>
    <span class="star" onclick="openMemory(3)">‚≠ê</span>
    <span class="star" onclick="openMemory(4)">‚≠ê</span>
  </div>
  <p id="star-hint" class="hint">Open every star to unlock my heart‚Ä¶</p>
</div>

<!-- STEP 4 -->
<div id="step4" class="step">
  <h2>üíò Catch My Love</h2>
  <p>My heart belongs to you‚Ä¶ but can you catch it?</p>
  <button id="final-btn" onmouseover="dodge(this)" onclick="celebrate()">Catch Me ‚ù§Ô∏è</button>
  <p id="catch-msg" class="hint"></p>
</div>

<!-- STEP 5 -->
<div id="step5" class="step">
  <div class="final-card">
    <img src="https://images.unsplash.com/photo-1518199266791-5375a83190b7?w=800&q=80" alt="Romantic moment" style="object-fit: cover; height: 250px;">
    <h2>My Favorite Forever üíç</h2>
    <p>If love were code, you'd be my infinite loop‚Ä¶ I choose you, always and forever üíñ</p>
    <p style="margin-top:15px; font-style:italic; color: var(--love);">Happy Birthday, My Love! üéÇ‚ú®</p>
  </div>
</div>

</div>

<!-- MEMORY MODAL -->
<div id="memoryModal">
  <div class="memory-box">
    <img id="memoryImg">
    <p id="memoryText"></p>
    <button onclick="closeMemory()">Close üíñ</button>
  </div>
</div>

<script>
const correctMonth = 8;
let openedStars = new Set();

const memories = [
 {img:"https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?w=800&q=80", text:"The day I saw your smile and forgot how to breathe."},
 {img:"https://images.unsplash.com/photo-1518621736915-f3b1c41bfd00?w=800&q=80", text:"Our first laugh that felt like home."},
 {img:"https://images.unsplash.com/photo-1529333166437-7750a6dd5a70?w=800&q=80", text:"That random moment I realized I was already yours."},
 {img:"https://images.unsplash.com/photo-1474552226712-ac0f0961a954?w=800&q=80", text:"The night our worlds collided‚Ä¶ and my heart chose you."},
 {img:"https://images.unsplash.com/photo-1522673607200-164d1b6ce486?w=800&q=80", text:"Every second since has been my favorite."}
];

// Create floating particles
function createParticles() {
  for(let i = 0; i < 30; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.left = Math.random() * 100 + '%';
    particle.style.top = Math.random() * 100 + '%';
    particle.style.animationDelay = Math.random() * 8 + 's';
    particle.style.animationDuration = (8 + Math.random() * 4) + 's';
    document.body.appendChild(particle);
  }
}

// Create floating hearts
function createFloatingHearts() {
  setInterval(() => {
    const heart = document.createElement('div');
    heart.className = 'floating-heart';
    heart.innerText = 'üíï';
    heart.style.left = Math.random() * 100 + '%';
    heart.style.animationDuration = (12 + Math.random() * 8) + 's';
    document.body.appendChild(heart);
    
    setTimeout(() => heart.remove(), 20000);
  }, 3000);
}

createParticles();
createFloatingHearts();

function positionStars(){
 const positions = [
   {left: '15%', top: '20%'},
   {left: '75%', top: '15%'},
   {left: '50%', top: '45%'},
   {left: '25%', top: '70%'},
   {left: '80%', top: '65%'}
 ];
 
 document.querySelectorAll('.star').forEach((s, i) => {
   s.style.left = positions[i].left;
   s.style.top = positions[i].top;
   s.style.animationDelay = (i * 0.3) + 's';
 });
}
positionStars();

function nextStep(n, e){
 if(e) e.stopPropagation();
 
 // Smooth transition
 const current = document.querySelector('.step.active');
 current.style.animation = 'fadeSlideOut 0.5s ease';
 
 setTimeout(() => {
   document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
   const next = document.getElementById('step' + n);
   next.classList.add('active');
   next.style.animation = 'fadeSlideIn 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
 }, 300);
}

function updateSlider(v){
 const months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
 dateValue.innerText = months[v-1];
 
 // Create sparkles on slider
 if(Math.random() > 0.7) {
   const slider = document.querySelector('input[type="range"]');
   const rect = slider.getBoundingClientRect();
   createSparkle(rect.left + (v/12) * rect.width, rect.top);
 }
 
 if(+v === correctMonth) {
   confetti({
     particleCount: 50,
     spread: 60,
     origin: { y: 0.5 }
   });
   setTimeout(() => nextStep(3), 1000);
 }
}

function openMemory(i){
 memoryImg.src = memories[i].img;
 memoryText.innerText = memories[i].text;
 memoryModal.style.display = "flex";
 
 // Confetti on opening memory
 confetti({
   particleCount: 30,
   spread: 50,
   origin: { x: 0.5, y: 0.5 }
 });
 
 openedStars.add(i);
 
 if(openedStars.size === 5){
   document.getElementById('star-hint').innerText = "‚ú® All memories unlocked‚Ä¶ my heart is ready üíñ";
   setTimeout(() => nextStep(4), 1500);
 }
}

function closeMemory(){ 
  memoryModal.style.display = "none"; 
}

function createSparkle(x, y){
  for(let i = 0; i < 5; i++) {
    const s = document.createElement("div");
    s.className = "sparkle";
    s.style.left = (x + (Math.random() - 0.5) * 30) + "px";
    s.style.top = (y + (Math.random() - 0.5) * 30) + "px";
    s.style.animationDelay = (i * 0.1) + "s";
    document.body.appendChild(s);
    setTimeout(() => s.remove(), 1000);
  }
}

function dodge(btn){
  if(!window.dodgeCount) window.dodgeCount = 0;

  const rect = btn.getBoundingClientRect();

  // Enhanced sparkle trail
  for(let i = 0; i < 12; i++){
    createSparkle(
      rect.left + Math.random() * rect.width,
      rect.top + Math.random() * rect.height
    );
  }

  if(window.dodgeCount < 4){
    const maxX = window.innerWidth - rect.width - 100;
    const maxY = window.innerHeight - rect.height - 100;
    
    btn.style.transform = `translate(${Math.random() * 300 - 150}px, ${Math.random() * 200 - 100}px) rotate(${Math.random() * 20 - 10}deg)`;
    window.dodgeCount++;
  } else {
    btn.onmouseover = null;
    btn.style.transform = "translate(0,0) rotate(0deg)";
    btn.innerText = "You caught me, my darling üíñ";
    btn.style.background = "linear-gradient(135deg, var(--love), var(--purple))";
    btn.style.color = "white";
    document.getElementById('catch-msg').innerText = "My heart is yours forever‚Ä¶";

    // Massive confetti
    confetti({
      particleCount: 150,
      spread: 100,
      origin: { y: 0.6 }
    });

    setTimeout(() => celebrate(), 1200);
  }
}

let celebrated = false;

function celebrate(){
  if(celebrated) return;
  celebrated = true;

  document.getElementById('bg-music').play().catch(e => console.log('Audio autoplay blocked'));
  
  // Multiple confetti bursts
  confetti({ 
    particleCount: 200, 
    spread: 120, 
    origin: { y: 0.6 },
    colors: ['#ff4d6d', '#ffb3c6', '#ffd700', '#a855f7']
  });
  
  setTimeout(() => {
    confetti({ 
      particleCount: 100, 
      angle: 60,
      spread: 55,
      origin: { x: 0 }
    });
    confetti({ 
      particleCount: 100, 
      angle: 120,
      spread: 55,
      origin: { x: 1 }
    });
  }, 250);

  setTimeout(() => nextStep(5), 1200);
}

// Add fadeSlideOut animation
const style = document.createElement('style');
style.textContent = `
  @keyframes fadeSlideOut {
    from {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    to {
      opacity: 0;
      transform: translateY(-40px) scale(0.95);
    }
  }
`;
document.head.appendChild(style);

</script>

</body>
</html>
